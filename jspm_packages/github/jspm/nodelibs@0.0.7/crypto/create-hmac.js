/* */
"format cjs";function Hmac(e,t){if(!(this instanceof Hmac))return new Hmac(e,t);Transform.call(this),this._opad=i,this._alg=e;var r="sha512"===e||"sha384"===e?128:64;t=this._key=Buffer.isBuffer(t)?t:new Buffer(t),t.length>r?t=createHash(e).update(t).digest():t.length<r&&(t=Buffer.concat([t,zeroBuffer],r));for(var n=this._ipad=new Buffer(r),i=this._opad=new Buffer(r),s=0;r>s;s++)n[s]=54^t[s],i[s]=92^t[s];this._hash=createHash(e).update(n)}var Buffer=require("../buffer").Buffer,createHash=require("./create-hash"),Transform=require("../stream").Transform,inherits=require("../util").inherits,zeroBuffer=new Buffer(128);zeroBuffer.fill(0),module.exports=Hmac,inherits(Hmac,Transform),Hmac.prototype.update=function(e,t){return this.write(e,t),this},Hmac.prototype._transform=function(e,t,r){this._hash.update(e),r()},Hmac.prototype._flush=function(e){var t=this._hash.digest();this.push(createHash(this._alg).update(this._opad).update(t).digest()),e()},Hmac.prototype.digest=function(e){this.end();for(var t,r=new Buffer("");t=this.read();)r=Buffer.concat([r,t]);return e&&(r=r.toString(e)),r};
//# sourceMappingURL=create-hmac.js.map